<div class="container">
  <div class="swaps-box">
    <div class="flex-title-swaps">
      <h2 class="swaps-title">My Swaps </h2>
      <%= link_to "Choose another book", books_path, class: "btn-dark-green" %>
    </div>
    <div class="row">
      <div class="col-12">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
          <li class="nav-item">
           <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Pending</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Complete</a>
          </li>
        </ul>

        <div class="tab-content" id="myTabContent">
          <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
            <div class="pending-swaps">

              <h3>My Pending Swaps</h3>
              <% if @swaps.where.not(status: 'complete').empty? %>
                <p>You have no pending swaps!</p>
              <% end %>

              <% @swaps.each do |swap| %>

                    <% if swap.giving_user == current_user && swap.status == 'pending' %>
                      <div class="bookswap-card d-flex">
                        <div class="d-flex">
                          <img id="book-photo" src= "<%= swap.book_given.photo %>" />
                          <div class="bookswap-card-info">
                            <h4><%= "Request received from #{swap.receiving_user.first_name.capitalize}" %></h4>
                            <p><%= "Book #{swap.receiving_user.first_name.capitalize} would like: #{swap.book_given.title}, #{swap.book_given.year}" %></p>
                            <p><%= "#{swap.receiving_user.first_name.capitalize}'s Location: #{swap.giving_user.location}" %></p>
                            <p><%= "Choose one of #{swap.receiving_user.first_name.capitalize}'s books or reject the request:" %></p>
                            <%= link_to "Choose a Book", choose_book_swap_path(swap), class: "btn-light-green" %>
                            <%= link_to "Reject Request", root_path, class: "btn-light-green" %>
                          </div>
                        </div>
                      </div>
                    <% end %>


                    <% if swap.receiving_user == current_user && swap.status == 'pending' %>
                      <div class="bookswap-card d-flex">
                        <div class="d-flex">
                          <img id="book-photo" src= "<%= swap.book_given.photo %>" />
                          <div class="bookswap-card-info">
                            <h4><%= "Request sent to #{swap.giving_user.first_name.capitalize}" %></h4>
                            <p><%= "Book you would like: #{swap.book_given.title}, #{swap.book_given.year}" %></p>
                            <p><%= "#{swap.giving_user.first_name.capitalize}'s Location: #{swap.giving_user.location}" %></p>
                            <p><%= "Waiting for #{swap.giving_user.first_name.capitalize} to approve your request" %></p>
                            <%= link_to "Cancel Request", root_path, class: "btn-light-green" %>
                          </div>
                        </div>
                      </div>
                    <% end %>




                  </div>
                </div>
              <% end %>
            </div>

          <div class="icon-with-text tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            <div class="complete-swaps">
              <h3>My Completed Swaps</h3>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

